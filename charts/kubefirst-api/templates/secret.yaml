{{- if not .Values.existingSecret }}
# retrieve the secret data using the lookup function or return an empty dictionary if empty
{{- $secretObj := (lookup "v1" "Secret" .Release.Namespace "kubefirst-initial-secrets") | default dict }}
{{- $secretData := (get $secretObj "data") | default dict }}
# set $initialPassword to existing secret data of mongodb-root-password or generate a random password when one does not exist
{{- $initialPassword := "feedkray" | b64enc | quote }}
apiVersion: v1
kind: Secret
metadata:
  name: kubefirst-initial-secrets
type: Opaque
data:
  mongodb-passwords: {{ $initialPassword }}
  mongodb-root-password: {{ $initialPassword }}
  mongodb-metrics-password: {{ $initialPassword }}
  mongodb-replica-set-key: {{ $initialPassword }}
  MONGO_INITDB_ROOT_PASSWORD: {{ $initialPassword }}
  MONGO_INITDB_ROOT_USERNAME:  {{ "root" | b64enc | quote }}
  K1_ACCESS_TOKEN: {{ $initialPassword }}
{{- end }}
